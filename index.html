<!-- index1.03.html â€” Stealth + Secure + Collections + Dark/Light Toggle -->
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="hehehe.id - Stealth Secure Player" />
  <title>hehehe.id â€” index1.03</title>

  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' 'unsafe-inline' https:; connect-src 'self' https:; frame-src https:; img-src 'self' data: https:; style-src 'self' 'unsafe-inline'; object-src 'none'; base-uri 'self'; frame-ancestors *;">

  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:#fff;color:#222;line-height:1.5}
    [data-theme="dark"] body{background:#0f0f0f;color:#f2f2f2}

    .header{padding:12px 20px;border-bottom:1px solid #e6e6e6;display:flex;justify-content:space-between;align-items:center}
    .logo{font-weight:700;font-size:20px;text-decoration:none;color:inherit}
    .nav a{margin-left:10px;padding:8px 12px;border-radius:8px;border:1px solid #ddd;text-decoration:none;color:inherit}
    .nav a:hover{background:#ececec}

    .container{max-width:1100px;margin:30px auto;padding:0 16px}
    .video-frame{background:#000;border-radius:8px;min-height:360px;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .loading{padding:40px;text-align:center;color:#888}
    .btn{cursor:pointer;border:0;padding:10px 16px;border-radius:8px}
    .btn-next{background:linear-gradient(45deg,#FF6B6B,#4ECDC4);color:#fff}

    .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.85);display:flex;align-items:center;justify-content:center;z-index:9999}
    .modal{background:#fff;padding:28px;border-radius:12px;max-width:420px;width:92%;text-align:center}
    [data-theme="dark"] .modal{background:#222;color:#fff}

    .modal-btn{padding:10px 18px;margin:6px;border-radius:8px;background:#eee;border:0;cursor:pointer}
    .modal-btn:hover{background:#ddd}
  </style>
</head>
<body>

<!-- MODAL NOTICE + THEME BUTTON -->
<div class="modal-overlay" id="modalNotice" style="display:flex">
  <div class="modal">
    <h2>Dengan melanjutkan dosa ditanggung sendiri-sendiri</h2>
    <p style="min-height:20px"></p>
    <button class="modal-btn" id="continueBtn">Lanjutkan</button>
    <button class="modal-btn" id="confirmBtn">Gass</button>
  </div>
</div>
<button id="themeToggle" style="position:fixed;bottom:20px;right:20px;padding:10px 14px;border-radius:8px;border:1px solid #ccc;cursor:pointer">ðŸŒ“ Mode</button>

<!-- HEADER -->
<header class="header">
  <a class="logo" href="/">hehehe.id</a>
  <nav class="nav">
    <a href="#play-eksib">Eksib</a>
    <a href="#play-hijab">Hijab</a>
    <a href="/">Home</a>
    <a href="/pasang-iklan.html">Pasang Iklan</a>
  </nav>
</header>

<!-- CONTENT -->
<main class="container">
  <article id="videoBox"><div class="loading">Memuat video...</div></article>
  <div style="text-align:center;margin-top:18px">
    <button class="btn btn-next" id="nextRandomBtn">ðŸ”€ Video Acak Berikutnya</button>
  </div>
</main>

<footer style="text-align:center;padding:30px 0;color:#888">Â© <span id="year"></span> hehehe.id</footer>

<script>
(function(){
  'use strict';

  /* CONFIG */
  const HOMEPAGE = "https://gist.githubusercontent.com/lihatlive01-sudo/5e3ba9c9392793aa815941cdec58459c/raw/playlist.txt";
  const COLLECTIONS = {
    "eksib": "https://gist.githubusercontent.com/lihatlive01-sudo/3aaa2daa010f9/raw/halaman2.txt",
    "hijab": "https://gist.githubusercontent.com/lihatlive01-sudo/869721f437c8/raw/halaman1.txt",
    "funny-people": HOMEPAGE
  };

  const SMARTLINK = "https://www.effectivegatecpm.com/vsft88c6?key=2fad6f717c5d155f438ee18cb2aea5cf";
  const ALLOWED = new Set();

  function allowHost(url){ try{ const u=new URL(url); ALLOWED.add(u.hostname);}catch{} }
  allowHost(SMARTLINK);

  function safeOpen(url){ try{ const u=new URL(url); if(!ALLOWED.has(u.hostname)) return false; window.open(url,"_blank","noopener,noreferrer"); return true;}catch{return false;} }

  function isHTTPS(x){ try{ return new URL(x).protocol==="https:";}catch{return false;} }
  function decodeB64(x){ try{ const d=atob(x); return /[<>]/.test(d)?null:d;}catch{return null;} }

  async function fetchList(url){
    try{
      const t = await (await fetch(url,{cache:'no-store'})).text();
      const arr = t.split("\n").map(s=>s.trim()).filter(isHTTPS);
      arr.forEach(allowHost);
      return [...new Set(arr)];
    }catch{return []}
  }

  function render(url,list=[],cat=null){
    const box = document.getElementById("videoBox");
    box.innerHTML="";

    if(!isHTTPS(url)){ box.innerHTML="<div class='loading'>Video tidak valid</div>"; return; }

    const wrap = document.createElement("div"); wrap.className="video-frame";
    const iframe=document.createElement("iframe");
    iframe.src=url;
    iframe.allow="accelerometer; autoplay; encrypted-media; picture-in-picture";
    iframe.allowFullscreen=true;
    iframe.style.width="100%";
    iframe.style.height="480px";
    wrap.appendChild(iframe);
    box.appendChild(wrap);

    if(list.length) sessionStorage.setItem("currentPlaylist", JSON.stringify(list));
    if(cat) sessionStorage.setItem("currentCategory",cat);
  }

  async function loadHome(){ const L=await fetchList(HOMEPAGE); if(L.length) render(L[Math.floor(Math.random()*L.length)],L); }
  async function loadCat(cat){ const url=COLLECTIONS[cat]; if(!url) return loadHome(); const L=await fetchList(url); if(L.length) render(L[Math.floor(Math.random()*L.length)],L,cat); else loadHome(); }

  function nextVid(){ const d=sessionStorage.getItem("currentPlaylist"); if(!d) return loadHome(); try{ const L=JSON.parse(d); render(L[Math.floor(Math.random()*L.length)],L);}catch{loadHome();} }

  /* MODAL */
  function openModal(){ document.getElementById("modalNotice").style.display="flex"; setTimeout(()=>safeOpen(SMARTLINK),5000); }
  function closeModal(){ document.getElementById("modalNotice").style.display="none"; sessionStorage.setItem("noticeAck","true"); safeOpen(SMARTLINK); }

  setInterval(openModal,180000);

  document.getElementById("year").textContent = new Date().getFullYear();

  /* THEME */
  (function(){
    const root=document.documentElement;
    const s=localStorage.getItem('theme');
    if(s) root.setAttribute('data-theme',s);
    document.getElementById('themeToggle').onclick=function(){
      const cur=root.getAttribute('data-theme')==='dark'?'light':'dark';
      root.setAttribute('data-theme',cur);
      localStorage.setItem('theme',cur);
    };
  })();

  document.addEventListener("DOMContentLoaded", async ()=>{
    if(sessionStorage.getItem("noticeAck")!=='true') openModal();

    const h=location.hash;
    if(h.startsWith('#play-')){
      const cat=h.replace('#play-',''); await loadCat(cat); history.replaceState(null,null,' ');
    } else if(h.startsWith('#dl=')){
      const d=decodeB64(h.slice(4)); if(d&&isHTTPS(d)) render(d); else await loadHome(); history.replaceState(null,null,' ');
    } else await loadHome();

    document.getElementById("continueBtn").onclick=closeModal;
    document.getElementById("confirmBtn").onclick=closeModal;
    document.getElementById("nextRandomBtn").onclick=nextVid;
  });
})();
</script>
</body>
</html>
